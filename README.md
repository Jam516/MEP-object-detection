# MEP-object-detection :robot:
MEng Dissertation project training Faster R-CNN to detect sockets and radiators in 360 images of interior spaces

## Rationale
Scan-to-BIM systems convert image and point cloud data into accurate 3D models
of buildings. Research on Scan-to-BIM has largely focused on the automated
identification of structural components. However, design and maintenance
projects require information on a range of other assets including mechanical,
electrical and plumbing (MEP) components. My dissertation presented a deep
learning solution that locates and labels MEP components in photos and thereby
adds useful context to BIM models.

A dataset of 249 labelled images was built to train the deep learning model. The
Faster R-CNN achieved a mean average precision (mAP) of 0.951 and an average
recall (AR) of 0.779 when trained with benchmark parameters on the augmented
dataset.


## Dataset Management
The following Python programs were written to automate the data management process:
* Prep.ipynb - This Jupyter notebook randomly splits the images into a validation
  set and a train set
* Tile img.py - This script loops through the training and validation images
  and segments each of them into six new images
* xml to csv.py - This script, which was adapted from (Tran, 2017), converts
  the XML label data generated by LabelImg to CSV format
* generate tfrecords.py - This script, which was adapted from (Tran, 2017),
  converts the CSV label data to TFRECORD format. This is the format
  accepted by Tensorflow
* Dataset analysis.ipynb - This Jupyter notebook analyses and generates plots
  on the the size distribution and category distribution of the dataset

## Model training
The following Jupyter Notebooks were developed to manage the training and validation process:
* Model gym.ipynb - This notebook mounts the Google Drive where the dataset
  is stored, installs the Tensorflow Object Detection API, integrates the COCO
  API, and trains and validates models
* Model testbed.ipynb - This notebook compares and contrasts the developed
  models according to key metrics and generates plots
